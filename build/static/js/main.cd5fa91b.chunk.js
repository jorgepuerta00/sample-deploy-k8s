(this["webpackJsonpsample-app"]=this["webpackJsonpsample-app"]||[]).push([[0],{46:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),s=n(39),o=n.n(s),i=(n(46),n(3)),j=n(15),l=n(5),u=n(23),b=function(){return sessionStorage.getItem("token")||null},d=function(){sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},h=function(e,t){sessionStorage.setItem("token",e),sessionStorage.setItem("user",JSON.stringify(t))},p=n(4),O=n.n(p),x=n(7),m=n(19),f=n.n(m),v="https://users-l7rh776aha-uc.a.run.app/api",g={headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwibmFtZSI6IkplbiBKb25lcyIsImlhdCI6MTU5MDExNzY2OH0.Z50ZjBVzVA8l5Lxzjku2q1edyOPboUEOMLOYufsSGm0"}},w={createUser:"users",getUserById:"users/",verifyIdToken:"users/verifyIdToken/"},y=function(){var e=a.useState(),t=Object(i.a)(e,2),n=t[0],r=t[1],c=a.useState(!1),s=Object(i.a)(c,2),o=s[0],j=s[1],l=a.useState(),u=Object(i.a)(l,2),b=u[0],d=u[1],h=f.a.create({baseURL:v});return[o,n,b,function(){var e=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),d(""),e.next=5,h.get("".concat(w.getUserById).concat(t),g).then((function(e){r(e.data.data)})).catch((function(e){d("Error retriving data from database.")}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0);case 10:return e.prev=10,j(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}()]},S=n(22);n(66);S.a.initializeApp({apiKey:"AIzaSyApaIbCPZIEyJVjlNwzUZZDUpHI_KwOOjE",authDomain:"sample-microservice-oiga.firebaseapp.com",projectId:"sample-microservice-oiga",storageBucket:"sample-microservice-oiga.appspot.com",messagingSenderId:"913926175112",appId:"1:913926175112:web:56d9a596586e0d0528a23d"});S.a.auth();var I=function(){var e=a.useState(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],c=a.useState(),s=Object(i.a)(c,2),o=s[0],j=s[1],l=a.useState(""),u=Object(i.a)(l,2),b=u[0],d=u[1],h=a.useState(),p=Object(i.a)(h,2),m=p[0],f=p[1];return[n,b,o,m,function(){var e=Object(x.a)(O.a.mark((function e(t,n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),f(""),e.next=5,S.a.auth().signInWithEmailAndPassword(t,n).then((function(e){d(e.user.ya),j(e.user)})).catch((function(e){f(null!=e?e.message:"Something went wrong. Please try again later.")}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0);case 10:return e.prev=10,r(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t,n){return e.apply(this,arguments)}}()]},k=function(){var e=a.useState(),t=Object(i.a)(e,2),n=t[0],r=t[1],c=a.useState(!1),s=Object(i.a)(c,2),o=s[0],j=s[1],l=a.useState(),u=Object(i.a)(l,2),b=u[0],d=u[1],h=f.a.create({baseURL:v});return[o,n,b,function(){var e=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),d(""),e.next=5,h.post("".concat(w.createUser),t,g).then((function(e){r("Saved succesfully!")})).catch((function(e){d("Error saving to database.")}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0);case 10:return e.prev=10,j(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}()]},L=n(16),N=n(24),E=function(e){var t=e.component,n=e.exact,a=e.path,c=Object(N.a)(e,["component","exact","path"]);return Object(r.jsx)(l.b,Object(L.a)(Object(L.a)({},c),{},{exact:n,path:a,render:function(e){return b()?Object(r.jsx)(t,Object(L.a)({},e)):Object(r.jsx)(l.a,{to:{pathname:"/login",state:{from:c.location}}})}}))},C=function(e){var t=e.component,n=(e.forceRedirect,e.redirectTo,e.path,Object(N.a)(e,["component","forceRedirect","redirectTo","path"]));return Object(r.jsx)(l.b,Object(L.a)(Object(L.a)({},n),{},{render:function(e){return b()?Object(r.jsx)(l.a,{to:{pathname:"/dashboard"}}):Object(r.jsx)(t,Object(L.a)({},e))}}))},A=function(){var e=a.useState(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],c=f.a.create({baseURL:v});return[n,function(){try{var e=b();if(!e)return;r(!0),c.get("".concat(w.verifyIdToken).concat(e),g).then((function(t){h(e,t.data.data)})).catch((function(e){d()}))}catch(t){console.warn(t)}finally{r(!1)}}]},U=function(e){var t=e.type,n=e.name,a=e.placeholder,c=e.errors,s=e.validation;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("input",{type:t,"aria-invalid":c[n]?"true":"false",placeholder:a,id:n,name:n,ref:s}),c[n]&&"required"===c[n].type&&Object(r.jsx)("span",{role:"alert",children:"This is required"}),c[n]&&"maxLength"===c[n].type&&Object(r.jsx)("span",{role:"alert",children:"Max length exceeded"}),c[n]&&"min"===c[n].type&&Object(r.jsx)("span",{role:"alert",children:"Should be greatter than 0"}),c[n]&&"max"===c[n].type&&Object(r.jsx)("span",{role:"alert",children:"Should be lower than 100"}),c[n]&&"pattern"===c[n].type&&Object(r.jsx)("span",{role:"alert",children:"Should be valid email"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]})};var q=function(e){var t=Object(u.a)(),n=t.register,a=t.handleSubmit,s=t.errors,o=I(),j=Object(i.a)(o,5),l=j[0],b=j[1],d=j[2],p=j[3],O=j[4];return c.a.useEffect((function(){l||""!==p||(h(b,d),e.history.push("/dashboard"))}),[l,p,b,d,e.history]),Object(r.jsxs)("form",{onSubmit:a((function(e){O(e.Email,e.Password)})),children:[Object(r.jsx)("div",{children:" Login "})," ",Object(r.jsx)("br",{}),Object(r.jsx)(U,{type:"text",placeholder:"Email",name:"Email",validation:n({required:!0,pattern:/^[\w-\\.]+@([\w-]+\.)+[\w-]{2,4}$/i}),errors:s}),Object(r.jsx)(U,{type:"password",placeholder:"Password",name:"Password",validation:n({required:!0,maxLength:20}),errors:s}),Object(r.jsx)("input",{type:"submit",value:l?"Loading...":"Login",disabled:l}),Object(r.jsx)("br",{}),p&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsx)("small",{children:p}),Object(r.jsx)("br",{})]}),Object(r.jsx)("br",{})]})};var F=function(e){var t=function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}(),n=y(),a=Object(i.a)(n,4),s=a[0],o=a[1],j=a[2],l=a[3];return c.a.useEffect((function(){l(t.uid)}),[]),s?Object(r.jsx)("div",{className:"content",children:"Retriving data..."}):""!==j?Object(r.jsxs)("div",{className:"content",children:[j&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsx)("small",{children:j}),Object(r.jsx)("br",{})]}),Object(r.jsx)("br",{})]}):Object(r.jsxs)("div",{children:["Welcome ",o.firstname," ",o.lastname,"!",Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),"Age: ",o.age,Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),"Score: ",o.score,Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"button",onClick:function(){d(),e.history.push("/login")},value:"Logout"})]})};var P=function(){var e=k(),t=Object(i.a)(e,4),n=t[0],a=t[1],c=t[2],s=t[3],o=Object(u.a)(),j=o.register,l=o.handleSubmit,b=o.errors;return n?Object(r.jsx)("div",{className:"content",children:"Saving data..."}):Object(r.jsxs)("form",{onSubmit:l((function(e){s(e)})),children:[Object(r.jsxs)("div",{children:["Welcome to the Register Page! ",Object(r.jsx)("br",{})," ",Object(r.jsx)("br",{})]}),Object(r.jsx)(U,{type:"text",placeholder:"First Name",name:"firstname",validation:j({required:!0,maxLength:30}),errors:b}),Object(r.jsx)(U,{type:"text",placeholder:"Last Name",name:"lastname",validation:j({required:!0,maxLength:30}),errors:b}),Object(r.jsx)(U,{type:"text",placeholder:"Email",name:"email",validation:j({required:!0,pattern:/^[\w-\\.]+@([\w-]+\.)+[\w-]{2,4}$/i}),errors:b}),Object(r.jsx)(U,{type:"text",placeholder:"Age",name:"age",validation:j({required:!0,max:100,min:0}),errors:b}),Object(r.jsx)(U,{type:"text",placeholder:"Score",name:"score",validation:j({required:!0,max:100,min:0}),errors:b}),Object(r.jsx)(U,{type:"password",placeholder:"Password",name:"password",validation:j({required:!0,maxLength:20}),errors:b}),Object(r.jsx)("input",{type:"submit"}),c&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsx)("small",{children:c}),Object(r.jsx)("br",{})]}),Object(r.jsx)("br",{}),a&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:a}),Object(r.jsx)("br",{})]}),Object(r.jsx)("br",{})]})},T=function(e){e.props;return Object(r.jsxs)("div",{className:"header",children:[Object(r.jsx)(j.b,{exact:!0,activeClassName:"active",to:"/",children:"Home"}),Object(r.jsx)(j.b,{activeClassName:"active",to:"/login",children:"Login"}),Object(r.jsx)("small",{children:"(Access without token only)"}),Object(r.jsx)(j.b,{activeClassName:"active",to:"/dashboard",children:"Dashboard"}),Object(r.jsx)("small",{children:"(Access with token only)"})]})};var B=function(){var e=A(),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){c()}),[c]),n?Object(r.jsx)("div",{className:"content",children:"Checking Authentication..."}):Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(j.a,{children:Object(r.jsxs)("div",{children:[Object(r.jsx)(T,{}),Object(r.jsx)("div",{className:"content",children:Object(r.jsxs)(l.d,{children:[Object(r.jsx)(l.b,{exact:!0,path:"/index",component:P}),Object(r.jsx)(C,{path:"/login",component:q}),Object(r.jsx)(E,{path:"/dashboard",component:F}),Object(r.jsx)(l.a,{from:"/",to:"/index"})]})})]})})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,73)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},R=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function z(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(r.jsx)(B,{}),document.getElementById("root")),J(),function(){if("serviceWorker"in navigator){if(new URL("",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");R?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):z(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):z(e)}))}}()}},[[72,1,2]]]);
//# sourceMappingURL=main.cd5fa91b.chunk.js.map